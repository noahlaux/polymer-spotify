<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="spotify-artist.html">
<link rel="import" href="spotify-track.html">

<polymer-element name="spotify-track-list" attributes="search" noscript>
    <template>
        <style>
            ul {
                list-style: none;
                margin: 0;
                padding: 0;
            }

            ul > li {
                margin-top: 10px;
            }
        </style>
        <ul>
            <template repeat="{{track in tracks}}">
                <li>
                    <spotify-artist artist="{{track.artists[0]}}"></spotify-artist> - <spotify-track track={{track}}></spotify-track>
                </li>
            </template>
        </ul>
    </template>
    <script src="/bower_components/spotify-web-api-js/src/spotify-web-api.js"></script>
    <script>
        Polymer('spotify-track-list', {
            created: function () {
                this.api = new SpotifyWebApi();
                this.tracks = [];
            },
            searchChanged: function (value) {
                if (value) {
                    this.api.searchTracks(value)
                        .then(function (response) {
                            this.tracks = response.tracks.items;
                        }.bind(this));
                }
            }
        });
    </script>
</polymer-element>
